<!-- Results Section -->
{{ block "results" . }}
<div id="grid-container" class="pt-10 pr-10 grid grid-cols-[1fr_3fr] grid-rows-[auto_1fr_auto] bg-white w-full gap-4">
    {{ template "sidecolumn" . }}
    <div id="results-and-pagination">
        {{ template "results-and-pagination" . }}
    </div>
</div>
<!-- This is swapped in to replace the input OOB to update the contents of the input when a suggestion is clicked-->

{{template "searchbar-oob" .}}

<!--This is swapped in to clear the contents of the suggestions dropdown when a suggestion is clicked-->
{{ template "suggestions-container-oob" . }}
{{end}}

{{ define "results-container" }}
<div id="results-content-container" class="space-y-6">
    {{ range $key, $value := .Results }}
		{{ template "result-card" $value }}
    {{ end }}
</div>
{{ end }}

{{ define "results-and-pagination" }}
    {{ template "results-container" . }}
    <div class="col-span-2">
        {{ template "pagination" .PageStatus }}
    </div>
{{ end }}

<!-- Individual Result Partial -->
{{ define "result-card" }}
<div class="hover:-translate-y-1 hover:scale-103 ease-in-out transition p-4 bg-white rounded-md shadow-md flex items-start space-x-4">
    <img src="https://placehold.co/120x120/webp" alt="Preview" class="w-24 h-24 object-cover rounded-md">
    <div>
        <a href="{{ .Link }}" target="_blank" rel="noopener noreferrer" class="text-lg font-semibold underline">
            {{ .Title }}
        </a>
        {{ $link := .Link }}
        {{ range $i, $excerpt := .Excerpts }}
        <div class="inline">
            <p class="text-gray-600">{{ $excerpt.Text }}
                <sup>
                    <a class="text-blue-500" target="_blank" rel="noopener noreferrer" href="{{ $link }}#page={{ $excerpt.PageNum }}">[{{ $excerpt.PageNum }}]</a>
                </sup>
            </p>
        </div>
        {{end}}
    </div>
</div>
{{end}}

{{ define "pagination" }}
<div class="flex justify-center items-center space-x-2 mt-4 p-4 bg-gray-100 rounded-lg shadow">
    {{ if .HasPrev }}
    <button
            hx-get="/search"
            hx-push-url="true"
            hx-target="#results-and-pagination"
            hx-include="#searchbar, #sidecolumn"
            hx-vals='{"page": "{{ .PrevPage }}"}'
            hx-swap="innerHTML"
            class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
    >
        Previous
    </button>
    {{ end }}

    <span class="px-4 py-2 bg-gray-300 rounded">{{ .CurrentPage }}</span>

    {{ if .HasNext }}
    <button
            hx-get="/search"
            hx-push-url="true"
            hx-target="#results-and-pagination"
            hx-include="#searchbar, #sidecolumn"
            hx-vals='{"page": "{{ .NextPage }}"}'
            hx-swap="innerHTML"
            class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
    >
        Next
    </button>
    {{ end }}
</div>
{{ end }}

